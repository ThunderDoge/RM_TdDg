# RM2020哨兵串口协议 v4.0

yhq 2020-5-18更新

## 协议设计原则

1. 尽量提高一帧中的有效信息比例
2. 按照裁判系统和传感器信息采集的周期,将周期相近的尽量合并在同一协议里
3. 增量式开发

## 链路层配置

1位起始位 ８位数据位 0奇偶校验位 1停止位 波特率460800

## 应用层协议

数据结构:总长18byte

| 帧首 | 功能字 | 数据 | 和检验 | 帧尾 |
| ---- | ------ | ---- | ------ | ---- |
| 0XFF | １位   | 14位 | 1位    | 0X0D |

说明:和检验为其他位(包括帧头帧尾)的和&0XFF，数据位为使用memcpy直接进行的数据拷贝,取出时应使用相同方式。

## 视觉控制指令

> 从0x01开始指定

1. 控制云台相对角度,TODO:增加射击控制相关指令

功能字宏定义:CMD_SEND_GIMBAL_RELATIVE_CONTROL

| 帧首 | 功能字 | pitch | yaw |是否需要射击|射击延时(单位ms)|射击模式(0模式调试模式1模式实战)| 和检验 | 帧尾 |
| ---- | ------ | ----- | ----- | ---- | ---- |---- | ----- | ------ | ---- | ------- |
| 0XFF | 0x01   | float | float|u8|float| u8  | 1位    | 0X0D |

## 电控信息反馈

> 从0x11开始指定

1. 云台状态,功能字0x11,TODO:增加底盘信息

功能字宏定义:CMD_RECV_GIMBAL_INFO

| 帧首 | 功能字 | pitch软角度 | yaw软件度 | yaw绝对角度 | 补零 | 和检验 | 帧尾 |
| ---- | ------ | ----------- | --------- | ----------- | ---- | ------ | ---- |
| 0XFF | 0x11   |float       | float     | float       | 2位  | 1位    | 0X0D |